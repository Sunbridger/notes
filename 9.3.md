
# 对babel的各个包的分析
>选自babel-webpack4-react仓库

```
"devDependencies": {
    "@babel/core": "^7.5.0", // 目前7.5.5为最新版本了
    "@babel/plugin-proposal-class-properties": "^7.5.0",
    "@babel/plugin-transform-runtime": "^7.5.0",
    "@babel/preset-env": "^7.5.0",
    "@babel/preset-react": "^7.0.0",
    "@babel/runtime": "^7.5.1", // 目前7.5.5为最新版本了
    "babel-loader": "^8.0.6",
    "core-js": "^2.6.9",
    "html-webpack-plugin": "^3.2.0",
    "webpack": "^4.35.2",
    "webpack-cli": "^3.3.5"
}
```
## @babel/core
[more](https://babeljs.io/docs/en/next/babel-core)
三种引入方式
```
var babel = require("@babel/core");
import { transform } from "@babel/core";
import * as babel from "@babel/core";
```

babel是个如下的对象
```
[Running] node "/Users/sunbridger/Desktop/mycode/notes/js/@babel-core.js"
{
  Plugin: [Function: Plugin],
  File: [Getter],
  buildExternalHelpers: [Getter],
  resolvePlugin: [Getter],
  resolvePreset: [Getter],
  version: [Getter],
  getEnv: [Getter],
  tokTypes: [Getter],
  traverse: [Getter],
  template: [Getter],
  createConfigItem: [Getter],
  loadPartialConfig: [Getter],
  loadOptions: [Getter],
  transform: [Getter],
  transformSync: [Getter],
  transformAsync: [Getter],
  transformFile: [Getter],
  transformFileSync: [Getter],
  transformFileAsync: [Getter],
  transformFromAst: [Getter],
  transformFromAstSync: [Getter],
  transformFromAstAsync: [Getter],
  parse: [Getter],
  parseSync: [Getter],
  parseAsync: [Getter],
  DEFAULT_EXTENSIONS: [ '.js', '.jsx', '.es6', '.es', '.mjs' ],
  OptionManager: [Function: OptionManager],
  types: [Getter]
}
```

1. babel.getEnv() 获取当前的环境 development 或 production
源码解析
```
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getEnv = getEnv;

function getEnv(defaultValue = "development") {
  return process.env.BABEL_ENV || process.env.NODE_ENV || defaultValue;
}
```
2. babel.transform() 
let a = 4;

经过babel的transform转换如下

```
{
  metadata: {},
  options: {
    babelrc: false,
    configFile: false,
    passPerPreset: false,
    envName: 'development',
    cwd: '/Users/sunbridger/Desktop/mycode',
    root: '/Users/sunbridger/Desktop/mycode',
    plugins: [],
    presets: [],
    parserOpts: { sourceType: 'module', sourceFileName: undefined, plugins: [] },
    generatorOpts: {
      filename: undefined,
      auxiliaryCommentBefore: undefined,
      auxiliaryCommentAfter: undefined,
      retainLines: undefined,
      comments: true,
      shouldPrintComment: undefined,
      compact: 'auto',
      minified: undefined,
      sourceMaps: false,
      sourceRoot: undefined,
      sourceFileName: 'unknown'
    }
  },
  ast: null,
  code: 'let a = 4;',
  map: null,
  sourceType: 'module'
}
```

## @babel/runtime
>it is meant to be used as a runtime dependency along with(随同) the Babel plugin` @babel/plugin-transform-runtime`.

```
class Circle {}
```
turn into
```
// 这就是每个文件的所谓的帮助函数
function _classCallCheck(instance, Constructor) {
  //...
}

var Circle = function Circle() {
  _classCallCheck(this, Circle);
};
```
这意味着包含类的每个文件每次都会重复_classCallCheck函数。
> @babel/runtime 只是这些帮助函数的集合（implementations of the functions in a modular way.）

